import{c as e,_ as a,f as t,R as r,b as s,L as l,w as n,A as o,d as i}from"./prefetch.helper-4a4e89e7.js";import{l as m,v as c}from"./store-87403b6b.js";import{u}from"./BEConfigProvider-697f66d7.js";import{g as d,p as b}from"./agent.helper-8c1fafa8.js";import{A as g,a as p}from"./AgentGeneralTab-62f9bb56.js";import{A as E,a as f}from"./AgentScheduleTab-f2a58cc2.js";import"./holiday.helper-ca9c72dc.js";import"./phoneInput.helper-24509875.js";import"./index-f3d162c1.js";import"./AvatarPicker-e9de6b9b.js";import"./HiddenInput-2f0ce489.js";import"./WeeklyScheduleEditor-df3fc586.js";import"./lodash-f550b173.js";import"./index-f9ec547e.js";function y(){const y=e.useActiveServices(),{toast:_}=a.useToast(),h=u(),[v]=t.Form.useForm(),k=e.useQueryClient(),T=e.useMutation({mutationKey:["agents","new"],mutationFn:m,onSuccess:e=>{k.setQueryData(["agent",e.agent_id],e),k.invalidateQueries({queryKey:["agents"]})}}),w=d(y);return r.createElement(r.Fragment,null,r.createElement(a.DrawerHeader,null,r.createElement(a.DrawerTitle,null,s.sprintf(s.__("New %(agent)s","bookster"),l)),r.createElement(a.DrawerCloseIcon,null)),r.createElement(a.DrawerBody,null,r.createElement(a.LoadingOverlay,{loading:T.isLoading}),r.createElement(t.Form,{form:v,initialValues:w,disabled:T.isLoading,layout:"vertical",scrollToFirstError:!0,onFinish:a=>{a.weekly_schedule=a.weekly_schedule?n(a.weekly_schedule):a.weekly_schedule,a.dayoff_schedule=a.dayoff_schedule?o(a.dayoff_schedule):a.dayoff_schedule,async function(a){try{const e=b(a);await c(e.email),await T.mutateAsync(e),_.success(s.sprintf(s.__("%(agent)s has been Saved Successfully!","bookster"),l)),h("..")}catch(t){_.error(await e.getErrorMsg(t))}}(a)}},r.createElement(a.TabsRoot,{defaultValue:"general"},r.createElement(a.TabsList,{"aria-label":"tabs settings"},r.createElement(a.LineTabsTrigger,{value:"general"},s.__("General","bookster")),r.createElement(a.LineTabsTrigger,{value:"available"},s.__("Available","bookster")),r.createElement(a.LineTabsTrigger,{value:"schedule"},s.__("Schedule","bookster")),r.createElement(a.LineTabsTrigger,{value:"daysoff"},s.__("Days Off","bookster")),i.booksterHooks.applyFilters(i.HOOK_NAMES.managerAgentForm.TabsTrigger,[])),r.createElement(a.TabsContent,{value:"general"},r.createElement(g,null)),r.createElement(a.TabsContent,{value:"available"},r.createElement(p,null)),r.createElement(a.TabsContent,{value:"schedule"},r.createElement(E,null)),r.createElement(a.TabsContent,{value:"daysoff"},r.createElement(f,null)),i.booksterHooks.applyFilters(i.HOOK_NAMES.managerAgentForm.TabsContent,[])),r.createElement("button",{type:"submit",className:"bw-hidden"}))),r.createElement(a.DrawerFooter,null,r.createElement(a.DrawerClose,{asChild:!0},r.createElement(a.Button,{key:"back",tabIndex:-1,variant:"trivial",className:"bw-min-w-[8rem]"},s.__("Cancel","bookster"))),r.createElement(a.Button,{key:"submit",disabled:T.isLoading,className:"bw-min-w-[8rem]",onClick:()=>v.submit()},s.__("Save","bookster"))))}export{y as default};
