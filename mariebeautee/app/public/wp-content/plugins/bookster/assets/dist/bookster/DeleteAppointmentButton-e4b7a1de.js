import{j as e,R as t,k as r,l as n,a,m as o,n as s,o as l,c,_ as i,u,r as m,f as d,L as b,b as p,d as f,q as w,s as h,e as v,T as g,D as y,t as E}from"./prefetch.helper-4a4e89e7.js";import{_}from"./createBookTimeInput.helper-a66a36a8.js";import{g as x,e as k,A as N,f as C,h as A}from"./BEConfigProvider-697f66d7.js";import{u as S,B as j}from"./useBreakpoint-2ef0bad1.js";import{u as F,_ as P,i as I,a as O,b as $}from"./index-f9ec547e.js";import{u as M,g as R}from"./useEffectWithTarget-688d6bb0.js";import{_ as T,i as D,a as B,b as L,c as z,d as V,u as q}from"./index-ad7a2af3.js";import{R as H,I as K,c as G,f as U,p as W}from"./appointment.helper-80ab8c9c.js";const Q={},J=function(e,t,r){if(!t||0===t.length)return e();const n=document.getElementsByTagName("link");return Promise.all(t.map((e=>{if((e=function(e){return"/wp-content/plugins/bookster/assets/dist/bookster/"+e}(e))in Q)return;Q[e]=!0;const t=e.endsWith(".css"),a=t?'[rel="stylesheet"]':"";if(r)for(let r=n.length-1;r>=0;r--){const a=n[r];if(a.href===e&&(!t||"stylesheet"===a.rel))return}else if(document.querySelector(`link[href="${e}"]${a}`))return;const o=document.createElement("link");return o.rel=t?"stylesheet":"modulepreload",t||(o.as="script",o.crossOrigin=""),o.href=e,document.head.appendChild(o),t?new Promise(((t,r)=>{o.addEventListener("load",t),o.addEventListener("error",(()=>r(new Error(`Unable to preload CSS for ${e}`))))})):void 0}))).then((()=>e())).catch((e=>{const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}))};var Z=(e=>(e.MANAGE_SHOP_SETTINGS_CAP="bookster_manage_shop_settings",e.MANAGE_SHOP_RECORDS_CAP="bookster_manage_shop_records",e.MANAGE_AGENT_SETTINGS_CAP="bookster_manage_agent_settings",e.MANAGE_AGENT_RECORDS_CAP="bookster_manage_agent_records",e.MANAGE_AGENT_PROFILE_CAP="bookster_manage_agent_profile",e))(Z||{});function X(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}function Y(){return Y=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Y.apply(this,arguments)}var ee={exports:{}},te={},re="function"==typeof Symbol&&Symbol.for,ne=re?Symbol.for("react.element"):60103,ae=re?Symbol.for("react.portal"):60106,oe=re?Symbol.for("react.fragment"):60107,se=re?Symbol.for("react.strict_mode"):60108,le=re?Symbol.for("react.profiler"):60114,ce=re?Symbol.for("react.provider"):60109,ie=re?Symbol.for("react.context"):60110,ue=re?Symbol.for("react.async_mode"):60111,me=re?Symbol.for("react.concurrent_mode"):60111,de=re?Symbol.for("react.forward_ref"):60112,be=re?Symbol.for("react.suspense"):60113,pe=re?Symbol.for("react.suspense_list"):60120,fe=re?Symbol.for("react.memo"):60115,we=re?Symbol.for("react.lazy"):60116,he=re?Symbol.for("react.block"):60121,ve=re?Symbol.for("react.fundamental"):60117,ge=re?Symbol.for("react.responder"):60118,ye=re?Symbol.for("react.scope"):60119;function Ee(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case ne:switch(e=e.type){case ue:case me:case oe:case le:case se:case be:return e;default:switch(e=e&&e.$$typeof){case ie:case de:case we:case fe:case ce:return e;default:return t}}case ae:return t}}}function _e(e){return Ee(e)===me}te.AsyncMode=ue,te.ConcurrentMode=me,te.ContextConsumer=ie,te.ContextProvider=ce,te.Element=ne,te.ForwardRef=de,te.Fragment=oe,te.Lazy=we,te.Memo=fe,te.Portal=ae,te.Profiler=le,te.StrictMode=se,te.Suspense=be,te.isAsyncMode=function(e){return _e(e)||Ee(e)===ue},te.isConcurrentMode=_e,te.isContextConsumer=function(e){return Ee(e)===ie},te.isContextProvider=function(e){return Ee(e)===ce},te.isElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===ne},te.isForwardRef=function(e){return Ee(e)===de},te.isFragment=function(e){return Ee(e)===oe},te.isLazy=function(e){return Ee(e)===we},te.isMemo=function(e){return Ee(e)===fe},te.isPortal=function(e){return Ee(e)===ae},te.isProfiler=function(e){return Ee(e)===le},te.isStrictMode=function(e){return Ee(e)===se},te.isSuspense=function(e){return Ee(e)===be},te.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===oe||e===me||e===le||e===se||e===be||e===pe||"object"==typeof e&&null!==e&&(e.$$typeof===we||e.$$typeof===fe||e.$$typeof===ce||e.$$typeof===ie||e.$$typeof===de||e.$$typeof===ve||e.$$typeof===ge||e.$$typeof===ye||e.$$typeof===he)},te.typeOf=Ee,ee.exports=te;var xe=ee.exports,ke=xe,Ne={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},Ce={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},Ae={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},Se={};function je(e){return ke.isMemo(e)?Ae:Se[e.$$typeof]||Ne}Se[ke.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},Se[ke.Memo]=Ae;var Fe=Object.defineProperty,Pe=Object.getOwnPropertyNames,Ie=Object.getOwnPropertySymbols,Oe=Object.getOwnPropertyDescriptor,$e=Object.getPrototypeOf,Me=Object.prototype;const Re=e((function e(t,r,n){if("string"!=typeof r){if(Me){var a=$e(r);a&&a!==Me&&e(t,a,n)}var o=Pe(r);Ie&&(o=o.concat(Ie(r)));for(var s=je(t),l=je(r),c=0;c<o.length;++c){var i=o[c];if(!(Ce[i]||n&&n[i]||l&&l[i]||s&&s[i])){var u=Oe(r,i);try{Fe(t,i,u)}catch(m){}}}}return t}));var Te=t.createContext(),De={},Be="PENDING",Le="REJECTED",ze=function(e){return e};function Ve(e){var r=e.defaultResolveComponent,n=void 0===r?ze:r,a=e.render,o=e.onLoad;function s(e,r){void 0===r&&(r={});var s=function(e){return"function"==typeof e?{requireAsync:e,resolve:function(){},chunkName:function(){}}:e}(e),l={};function c(e){return r.cacheKey?r.cacheKey(e):s.resolve?s.resolve(e):"static"}function i(e,t,a){var o=r.resolveComponent?r.resolveComponent(e,t):n(e);if(r.resolveComponent&&!xe.isValidElementType(o))throw new Error("resolveComponent returned something that is not a React component!");return Re(a,o,{preload:!0}),o}var u,m,d=function(e){var t=c(e),r=l[t];return r&&r.status!==Le||((r=s.requireAsync(e)).status=Be,l[t]=r,r.then((function(){r.status="RESOLVED"}),(function(t){console.error("loadable-components: failed to asynchronously load component",{fileName:s.resolve(e),chunkName:s.chunkName(e),error:t?t.message:t}),r.status=Le}))),r},b=function(e){function t(t){var n;return(n=e.call(this,t)||this).state={result:null,error:null,loading:!0,cacheKey:c(t)},function(e,t){if(!e){var r=new Error("loadable: SSR requires `@loadable/babel-plugin`, please install it");throw r.framesToPop=1,r.name="Invariant Violation",r}}(!t.__chunkExtractor||s.requireSync),t.__chunkExtractor?(!1===r.ssr||(s.requireAsync(t).catch((function(){return null})),n.loadSync(),t.__chunkExtractor.addChunk(s.chunkName(t))),function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(n)):(!1!==r.ssr&&(s.isReady&&s.isReady(t)||s.chunkName&&De[s.chunkName(t)])&&n.loadSync(),n)}_(t,e),t.getDerivedStateFromProps=function(e,t){var r=c(e);return Y({},t,{cacheKey:r,loading:t.loading||t.cacheKey!==r})};var n=t.prototype;return n.componentDidMount=function(){this.mounted=!0;var e=this.getCache();e&&e.status===Le&&this.setCache(),this.state.loading&&this.loadAsync()},n.componentDidUpdate=function(e,t){t.cacheKey!==this.state.cacheKey&&this.loadAsync()},n.componentWillUnmount=function(){this.mounted=!1},n.safeSetState=function(e,t){this.mounted&&this.setState(e,t)},n.getCacheKey=function(){return c(this.props)},n.getCache=function(){return l[this.getCacheKey()]},n.setCache=function(e){void 0===e&&(e=void 0),l[this.getCacheKey()]=e},n.triggerOnLoad=function(){var e=this;o&&setTimeout((function(){o(e.state.result,e.props)}))},n.loadSync=function(){if(this.state.loading)try{var e=i(s.requireSync(this.props),this.props,f);this.state.result=e,this.state.loading=!1}catch(t){console.error("loadable-components: failed to synchronously load component, which expected to be available",{fileName:s.resolve(this.props),chunkName:s.chunkName(this.props),error:t?t.message:t}),this.state.error=t}},n.loadAsync=function(){var e=this,t=this.resolveAsync();return t.then((function(t){var r=i(t,e.props,f);e.safeSetState({result:r,loading:!1},(function(){return e.triggerOnLoad()}))})).catch((function(t){return e.safeSetState({error:t,loading:!1})})),t},n.resolveAsync=function(){var e=this.props;e.__chunkExtractor,e.forwardedRef;var t=X(e,["__chunkExtractor","forwardedRef"]);return d(t)},n.render=function(){var e=this.props,t=e.forwardedRef,n=e.fallback;e.__chunkExtractor;var o=X(e,["forwardedRef","fallback","__chunkExtractor"]),s=this.state,l=s.error,c=s.loading,i=s.result;if(r.suspense&&(this.getCache()||this.loadAsync()).status===Be)throw this.loadAsync();if(l)throw l;var u=n||r.fallback||null;return c?u:a({fallback:u,result:i,options:r,props:Y({},o,{ref:t})})},t}(t.Component),p=(m=function(e){return t.createElement(Te.Consumer,null,(function(r){return t.createElement(u,Object.assign({__chunkExtractor:r},e))}))},(u=b).displayName&&(m.displayName=u.displayName+"WithChunkExtractor"),m),f=t.forwardRef((function(e,r){return t.createElement(p,Object.assign({forwardedRef:r},e))}));return f.displayName="Loadable",f.preload=function(e){f.load(e)},f.load=function(e){return d(e)},f}return{loadable:s,lazy:function(e,t){return s(e,Y({},t,{suspense:!0}))}}}var qe=Ve({defaultResolveComponent:function(e){return e.__esModule?e.default:e.default||e},render:function(e){var r=e.result,n=e.props;return t.createElement(r,n)}}),He=qe.loadable,Ke=qe.lazy,Ge=Ve({onLoad:function(e,t){e&&t.forwardedRef&&("function"==typeof t.forwardedRef?t.forwardedRef(e):t.forwardedRef.current=e)},render:function(e){var t=e.result,r=e.props;return r.children?r.children(t):null}}),Ue=Ge.loadable,We=Ge.lazy,Qe=He;function Je(){return t.createElement(r,null,t.createElement(n,{className:"bw-text-warning"},t.createElement(a.AlertCircle,{className:"bw-h-16 bw-w-16"})),t.createElement(o,null,"404"),t.createElement(s,null,"Sorry, Page Not Found."),t.createElement(l,null,t.createElement(c.Link,{to:"/"},t.createElement(i.Button,{variant:"outline"},"Go Back"))))}function Ze({avatarSrc:e}){const{displayName:r,role:n,avatarUrl:o}=u((e=>e.wpUserInfo));return t.createElement(i.DropdownMenu,null,t.createElement(i.DropdownMenuTrigger,{asChild:!0},t.createElement(i.Avatar,{className:"bw-h-8 bw-w-8 bw-cursor-pointer"},t.createElement(i.AvatarImage,{src:e||o}),t.createElement(i.AvatarFallback,null,t.createElement(a.UserRound,null)))),t.createElement(i.DropdownMenuContent,{align:"end"},t.createElement(i.DropdownMenuItem,{asChild:!0},t.createElement("div",null,t.createElement(i.Avatar,{className:"bw-h-8 bw-w-8"},t.createElement(i.AvatarImage,{src:e||o}),t.createElement(i.AvatarFallback,null,t.createElement(a.UserRound,null))),t.createElement("div",{className:"bw-pl-2"},t.createElement("h4",{className:"bw-font-semibold"},r),t.createElement("span",{className:"bw-text-base-foreground/60"},n)))),t.createElement(i.DropdownMenuSeparator,null),t.createElement(i.DropdownMenuItem,{asChild:!0},t.createElement("a",{className:"bw-w-full bw-pl-2 bw-text-black bw-no-underline",href:window.booksterMeta.wpPath.logoutUrl},t.createElement(a.LogOut,{className:"!bw-text-base"}),t.createElement("span",{className:"bw-ml-2"},"Logout")))))}Qe.lib=Ue,Ke.lib=We;var Xe=function(e,t){return e===t||e!=e&&t!=t},Ye=Xe,et=function(e,t){for(var r=e.length;r--;)if(Ye(e[r][0],t))return r;return-1},tt=et,rt=Array.prototype.splice,nt=et,at=et,ot=et,st=function(){this.__data__=[],this.size=0};function lt(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}lt.prototype.clear=st,lt.prototype.delete=function(e){var t=this.__data__,r=tt(t,e);return!(r<0||(r==t.length-1?t.pop():rt.call(t,r,1),--this.size,0))},lt.prototype.get=function(e){var t=this.__data__,r=nt(t,e);return r<0?void 0:t[r][1]},lt.prototype.has=function(e){return at(this.__data__,e)>-1},lt.prototype.set=function(e,t){var r=this.__data__,n=ot(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this};var ct,it=lt,ut=it,mt=T,dt=D,bt=function(e){if(!dt(e))return!1;var t=mt(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t},pt=B["__core-js_shared__"],ft=(ct=/[^.]+$/.exec(pt&&pt.keys&&pt.keys.IE_PROTO||""))?"Symbol(src)_1."+ct:"",wt=Function.prototype.toString,ht=function(e){if(null!=e){try{return wt.call(e)}catch(t){}try{return e+""}catch(t){}}return""},vt=bt,gt=function(e){return!!ft&&ft in e},yt=D,Et=ht,_t=/^\[object .+?Constructor\]$/,xt=Function.prototype,kt=Object.prototype,Nt=xt.toString,Ct=kt.hasOwnProperty,At=RegExp("^"+Nt.call(Ct).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),St=function(e,t){var r=function(e,t){return null==e?void 0:e[t]}(e,t);return function(e){return!(!yt(e)||gt(e))&&(vt(e)?At:_t).test(Et(e))}(r)?r:void 0},jt=St(B,"Map"),Ft=St(Object,"create"),Pt=Ft,It=Ft,Ot=Object.prototype.hasOwnProperty,$t=Ft,Mt=Object.prototype.hasOwnProperty,Rt=Ft,Tt=function(){this.__data__=Pt?Pt(null):{},this.size=0},Dt=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Bt=function(e){var t=this.__data__;if(It){var r=t[e];return"__lodash_hash_undefined__"===r?void 0:r}return Ot.call(t,e)?t[e]:void 0};function Lt(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Lt.prototype.clear=Tt,Lt.prototype.delete=Dt,Lt.prototype.get=Bt,Lt.prototype.has=function(e){var t=this.__data__;return $t?void 0!==t[e]:Mt.call(t,e)},Lt.prototype.set=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=Rt&&void 0===t?"__lodash_hash_undefined__":t,this};var zt=Lt,Vt=it,qt=jt,Ht=function(e,t){var r,n,a=e.__data__;return("string"==(n=typeof(r=t))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r)?a["string"==typeof t?"string":"hash"]:a.map},Kt=Ht,Gt=Ht,Ut=Ht,Wt=Ht;function Qt(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Qt.prototype.clear=function(){this.size=0,this.__data__={hash:new zt,map:new(qt||Vt),string:new zt}},Qt.prototype.delete=function(e){var t=Kt(this,e).delete(e);return this.size-=t?1:0,t},Qt.prototype.get=function(e){return Gt(this,e).get(e)},Qt.prototype.has=function(e){return Ut(this,e).has(e)},Qt.prototype.set=function(e,t){var r=Wt(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this};var Jt=Qt,Zt=it,Xt=jt,Yt=Jt,er=it,tr=function(){this.__data__=new ut,this.size=0},rr=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r},nr=function(e){return this.__data__.get(e)},ar=function(e){return this.__data__.has(e)};function or(e){var t=this.__data__=new er(e);this.size=t.size}or.prototype.clear=tr,or.prototype.delete=rr,or.prototype.get=nr,or.prototype.has=ar,or.prototype.set=function(e,t){var r=this.__data__;if(r instanceof Zt){var n=r.__data__;if(!Xt||n.length<199)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new Yt(n)}return r.set(e,t),this.size=r.size,this};var sr=or,lr=Jt;function cr(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new lr;++t<r;)this.add(e[t])}cr.prototype.add=cr.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},cr.prototype.has=function(e){return this.__data__.has(e)};var ir,ur,mr,dr,br,pr,fr,wr,hr=cr,vr=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1},gr=function(e,t,r,n,a,o){var s=1&r,l=e.length,c=t.length;if(l!=c&&!(s&&c>l))return!1;var i=o.get(e),u=o.get(t);if(i&&u)return i==t&&u==e;var m=-1,d=!0,b=2&r?new hr:void 0;for(o.set(e,t),o.set(t,e);++m<l;){var p=e[m],f=t[m];if(n)var w=s?n(f,p,m,t,e,o):n(p,f,m,e,t,o);if(void 0!==w){if(w)continue;d=!1;break}if(b){if(!vr(t,(function(e,t){if(s=t,!b.has(s)&&(p===e||a(p,e,r,n,o)))return b.push(t);var s}))){d=!1;break}}else if(p!==f&&!a(p,f,r,n,o)){d=!1;break}}return o.delete(e),o.delete(t),d},yr=B.Uint8Array,Er=Xe,_r=gr,xr=function(e){var t=-1,r=Array(e.size);return e.forEach((function(e,n){r[++t]=[n,e]})),r},kr=function(e){var t=-1,r=Array(e.size);return e.forEach((function(e){r[++t]=e})),r},Nr=L?L.prototype:void 0,Cr=Nr?Nr.valueOf:void 0,Ar=Array.isArray,Sr=function(e,t){for(var r=-1,n=t.length,a=e.length;++r<n;)e[a+r]=t[r];return e},jr=Ar,Fr=Object.prototype.propertyIsEnumerable,Pr=Object.getOwnPropertySymbols,Ir=Pr?function(e){return null==e?[]:(e=Object(e),function(e,t){for(var r=-1,n=null==e?0:e.length,a=0,o=[];++r<n;){var s=e[r];t(s,r,e)&&(o[a++]=s)}return o}(Pr(e),(function(t){return Fr.call(e,t)})))}:function(){return[]},Or=T,$r=z,Mr=function(e){return $r(e)&&"[object Arguments]"==Or(e)},Rr=z,Tr=Object.prototype,Dr=Tr.hasOwnProperty,Br=Tr.propertyIsEnumerable,Lr=Mr(function(){return arguments}())?Mr:function(e){return Rr(e)&&Dr.call(e,"callee")&&!Br.call(e,"callee")},zr={exports:{}};ir=zr,mr=B,dr=function(){return!1},wr=((fr=(pr=(br=(ur=zr.exports)&&!ur.nodeType&&ur)&&ir&&!ir.nodeType&&ir)&&pr.exports===br?mr.Buffer:void 0)?fr.isBuffer:void 0)||dr,ir.exports=wr;var Vr=zr.exports,qr=/^(?:0|[1-9]\d*)$/,Hr=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991},Kr=T,Gr=Hr,Ur=z,Wr={};Wr["[object Float32Array]"]=Wr["[object Float64Array]"]=Wr["[object Int8Array]"]=Wr["[object Int16Array]"]=Wr["[object Int32Array]"]=Wr["[object Uint8Array]"]=Wr["[object Uint8ClampedArray]"]=Wr["[object Uint16Array]"]=Wr["[object Uint32Array]"]=!0,Wr["[object Arguments]"]=Wr["[object Array]"]=Wr["[object ArrayBuffer]"]=Wr["[object Boolean]"]=Wr["[object DataView]"]=Wr["[object Date]"]=Wr["[object Error]"]=Wr["[object Function]"]=Wr["[object Map]"]=Wr["[object Number]"]=Wr["[object Object]"]=Wr["[object RegExp]"]=Wr["[object Set]"]=Wr["[object String]"]=Wr["[object WeakMap]"]=!1;var Qr={exports:{}};!function(e,t){var r=V,n=t&&!t.nodeType&&t,a=n&&e&&!e.nodeType&&e,o=a&&a.exports===n&&r.process,s=function(){try{return a&&a.require&&a.require("util").types||o&&o.binding&&o.binding("util")}catch(e){}}();e.exports=s}(Qr,Qr.exports);var Jr,Zr,Xr=Qr.exports,Yr=function(e){return Ur(e)&&Gr(e.length)&&!!Wr[Kr(e)]},en=function(e){return function(t){return e(t)}},tn=Xr&&Xr.isTypedArray,rn=tn?en(tn):Yr,nn=function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n},an=Lr,on=Ar,sn=Vr,ln=function(e,t){var r=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==r||"symbol"!=r&&qr.test(e))&&e>-1&&e%1==0&&e<t},cn=rn,un=Object.prototype.hasOwnProperty,mn=Object.prototype,dn=(Jr=Object.keys,Zr=Object,function(e){return Jr(Zr(e))}),bn=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||mn)},pn=dn,fn=Object.prototype.hasOwnProperty,wn=bt,hn=Hr,vn=function(e,t){var r=on(e),n=!r&&an(e),a=!r&&!n&&sn(e),o=!r&&!n&&!a&&cn(e),s=r||n||a||o,l=s?nn(e.length,String):[],c=l.length;for(var i in e)!t&&!un.call(e,i)||s&&("length"==i||a&&("offset"==i||"parent"==i)||o&&("buffer"==i||"byteLength"==i||"byteOffset"==i)||ln(i,c))||l.push(i);return l},gn=function(e,t,r){var n=t(e);return jr(e)?n:Sr(n,r(e))},yn=Ir,En=function(e){return null!=(t=e)&&hn(t.length)&&!wn(t)?vn(e):function(e){if(!bn(e))return pn(e);var t=[];for(var r in Object(e))fn.call(e,r)&&"constructor"!=r&&t.push(r);return t}(e);var t},xn=function(e){return gn(e,En,yn)},kn=Object.prototype.hasOwnProperty,Nn=St(B,"DataView"),Cn=jt,An=St(B,"Promise"),Sn=St(B,"Set"),jn=St(B,"WeakMap"),Fn=T,Pn=ht,In="[object Map]",On="[object Promise]",$n="[object Set]",Mn="[object WeakMap]",Rn="[object DataView]",Tn=Pn(Nn),Dn=Pn(Cn),Bn=Pn(An),Ln=Pn(Sn),zn=Pn(jn),Vn=Fn;(Nn&&Vn(new Nn(new ArrayBuffer(1)))!=Rn||Cn&&Vn(new Cn)!=In||An&&Vn(An.resolve())!=On||Sn&&Vn(new Sn)!=$n||jn&&Vn(new jn)!=Mn)&&(Vn=function(e){var t=Fn(e),r="[object Object]"==t?e.constructor:void 0,n=r?Pn(r):"";if(n)switch(n){case Tn:return Rn;case Dn:return In;case Bn:return On;case Ln:return $n;case zn:return Mn}return t});var qn=sr,Hn=gr,Kn=function(e,t,r,n,a,o,s){switch(r){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!o(new yr(e),new yr(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return Er(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var l=xr;case"[object Set]":var c=1&n;if(l||(l=kr),e.size!=t.size&&!c)return!1;var i=s.get(e);if(i)return i==t;n|=2,s.set(e,t);var u=_r(l(e),l(t),n,a,o,s);return s.delete(e),u;case"[object Symbol]":if(Cr)return Cr.call(e)==Cr.call(t)}return!1},Gn=function(e,t,r,n,a,o){var s=1&r,l=xn(e),c=l.length;if(c!=xn(t).length&&!s)return!1;for(var i=c;i--;){var u=l[i];if(!(s?u in t:kn.call(t,u)))return!1}var m=o.get(e),d=o.get(t);if(m&&d)return m==t&&d==e;var b=!0;o.set(e,t),o.set(t,e);for(var p=s;++i<c;){var f=e[u=l[i]],w=t[u];if(n)var h=s?n(w,f,u,t,e,o):n(f,w,u,e,t,o);if(!(void 0===h?f===w||a(f,w,r,n,o):h)){b=!1;break}p||(p="constructor"==u)}if(b&&!p){var v=e.constructor,g=t.constructor;v==g||!("constructor"in e)||!("constructor"in t)||"function"==typeof v&&v instanceof v&&"function"==typeof g&&g instanceof g||(b=!1)}return o.delete(e),o.delete(t),b},Un=Vn,Wn=Ar,Qn=Vr,Jn=rn,Zn="[object Arguments]",Xn="[object Array]",Yn="[object Object]",ea=Object.prototype.hasOwnProperty,ta=z,ra=function e(t,r,n,a,o){return t===r||(null==t||null==r||!ta(t)&&!ta(r)?t!=t&&r!=r:function(e,t,r,n,a,o){var s=Wn(e),l=Wn(t),c=s?Xn:Un(e),i=l?Xn:Un(t),u=(c=c==Zn?Yn:c)==Yn,m=(i=i==Zn?Yn:i)==Yn,d=c==i;if(d&&Qn(e)){if(!Qn(t))return!1;s=!0,u=!1}if(d&&!u)return o||(o=new qn),s||Jn(e)?Hn(e,t,r,n,a,o):Kn(e,t,c,r,n,a,o);if(!(1&r)){var b=u&&ea.call(e,"__wrapped__"),p=m&&ea.call(t,"__wrapped__");if(b||p){var f=b?e.value():e,w=p?t.value():t;return o||(o=new qn),a(f,w,r,n,o)}}return!!d&&(o||(o=new qn),Gn(e,t,r,n,a,o))}(t,r,n,a,e,o))};const na=e((function(e,t){return ra(e,t)}));var aa={0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,pausebreak:19,capslock:20,esc:27,space:32,pageup:33,pagedown:34,end:35,home:36,leftarrow:37,uparrow:38,rightarrow:39,downarrow:40,insert:45,delete:46,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,leftwindowkey:91,rightwindowkey:92,meta:/(mac|iphone|ipod|ipad)/i.test("undefined"!=typeof navigator?null===navigator||void 0===navigator?void 0:navigator.platform:"")?[91,93]:[91,92],selectkey:93,numpad0:96,numpad1:97,numpad2:98,numpad3:99,numpad4:100,numpad5:101,numpad6:102,numpad7:103,numpad8:104,numpad9:105,multiply:106,add:107,subtract:109,decimalpoint:110,divide:111,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,numlock:144,scrolllock:145,semicolon:186,equalsign:187,comma:188,dash:189,period:190,forwardslash:191,graveaccent:192,openbracket:219,backslash:220,closebracket:221,singlequote:222},oa={ctrl:function(e){return e.ctrlKey},shift:function(e){return e.shiftKey},alt:function(e){return e.altKey},meta:function(e){return"keyup"===e.type?aa.meta.includes(e.keyCode):e.metaKey}};function sa(e,t,r){var n,a;if(!e.key)return!1;if($(t))return e.keyCode===t;var o=t.split("."),s=0;try{for(var l=P(o),c=l.next();!c.done;c=l.next()){var i=c.value,u=oa[i],m=aa[i.toLowerCase()];(u&&u(e)||m&&m===e.keyCode)&&s++}}catch(d){n={error:d}}finally{try{c&&!c.done&&(a=l.return)&&a.call(l)}finally{if(n)throw n.error}}return r?s===o.length&&function(e){var t=Object.keys(oa).reduce((function(t,r){return oa[r](e)?t+1:t}),0);return[16,17,18,91,92].includes(e.keyCode)?t:t+1}(e)===o.length:s===o.length}var la=["keydown"];function ca(e,t,r){var n=r||{},a=n.events,o=void 0===a?la:a,s=n.target,l=n.exactMatch,c=void 0!==l&&l,i=n.useCapture,u=void 0!==i&&i,d=F(t),b=F(e);!function(e,t,r){var n,a,o=m.useRef(),s=m.useRef(0);n=t,void 0===(a=o.current)&&(a=[]),na(n,a)||(o.current=t,s.current+=1),M(e,[s.current],r)}((function(){var e,t,r,n=R(s,window);if(n){var a=function(e){var t,r=function(e,t){return I(e)?e:O(e)||$(e)?function(r){return sa(r,e,t)}:Array.isArray(e)?function(r){return e.some((function(e){return sa(r,e,t)}))}:function(){return Boolean(e)}}(b.current,c);if(r(e))return null===(t=d.current)||void 0===t?void 0:t.call(d,e)};try{for(var l=P(o),i=l.next();!i.done;i=l.next()){var m=i.value;null===(r=null==n?void 0:n.addEventListener)||void 0===r||r.call(n,m,a,u)}}catch(p){e={error:p}}finally{try{i&&!i.done&&(t=l.return)&&t.call(l)}finally{if(e)throw e.error}}return function(){var e,t,r;try{for(var s=P(o),l=s.next();!l.done;l=s.next()){var c=l.value;null===(r=null==n?void 0:n.removeEventListener)||void 0===r||r.call(n,c,a,u)}}catch(i){e={error:i}}finally{try{l&&!l.done&&(t=s.return)&&t.call(s)}finally{if(e)throw e.error}}}}}),[o],s)}var ia=function(e,t){return!Object.is(e,t)};function ua(){return t.createElement("div",{className:"btr-admin-page-logo-wrapper bw-flex bw-h-14 bw-flex-none bw-cursor-default bw-items-center bw-whitespace-nowrap bw-border-0 bw-border-b bw-border-solid bw-border-b-base-foreground bw-pl-8 bw-text-2xl bw-text-base-bg1"},t.createElement(a.Bookster,null),t.createElement("span",{className:"btr-logo-text bw-ml-3"},"Bookster"))}function ma({children:e}){const r=S(j.lg),n=function(e,t){void 0===t&&(t=ia);var r=m.useRef(),n=m.useRef();return t(n.current,e)&&(r.current=n.current,n.current=e),r.current}(r),[a,o]=m.useState(x().pageSider);function s(e){o(e),k({pageSider:e})}return m.useEffect((()=>{void 0!==n&&n!==r&&s(!r)}),[n,r]),t.createElement(d.Layout.Sider,{className:"btr-admin-page-sider",collapsedWidth:r?80:0,defaultCollapsed:x().pageSider,theme:"dark",width:210,collapsible:!0,collapsed:a,onCollapse:e=>{s(e)}},t.createElement(ua,null),e)}const{Content:da,Header:ba}=d.Layout;function pa({children:e,sideMenu:r,headerButtons:n,userInfo:a,searchGlobal:o}){return t.createElement(d.Layout,{className:"bw-h-screen"},t.createElement(ma,null,r),t.createElement(d.Layout,{className:"bw-flex bw-h-full bw-bg-base-bg1"},t.createElement(ba,{className:"bw-z-20 bw-flex bw-h-14 bw-flex-none bw-items-center bw-gap-4 bw-bg-base-bg1 bw-px-6 bw-shadow"},o,n,a),t.createElement(da,{className:"bw-relative bw-flex-grow"},e)))}const fa=m.createContext(void 0);function wa(){const e=m.useContext(fa);if(!e)throw new Error("Missing InputSearchHeaderContext.Provider in the tree");return e}const ha=m.forwardRef(((e,r)=>{const{setIsOpenModal:n}=wa();return ca(["meta.k"],(()=>{n(!0)})),t.createElement("div",{className:"bw-relative bw-me-auto bw-w-72 bw-shrink bw-cursor-pointer",onClick:e=>{e.stopPropagation(),n(!0)}},t.createElement(i.InputPrefix,null,t.createElement(a.Search,{className:"bw-h-5 bw-w-5"})),t.createElement(i.Input,{ref:r,className:"bw-h-9 bw-cursor-pointer !bw-rounded-lg bw-pe-8 bw-ps-10",placeholder:"Search",withStatus:!1,onFocus:e=>{e.target.blur()},...e,type:"text"}),t.createElement(i.InputSuffix,{className:"bw-my-1.5 bw-me-2 bw-rounded-lg bw-border bw-bg-base-bg2 bw-px-2 bw-opacity-100"},t.createElement("span",{className:"bw-text-base-foreground/60"},"⌘ K")))}));function va({appt:e}){var r,n,a,o,s;const{clickAppointment:l}=wa(),c=null==(r=null==e?void 0:e.agents)?void 0:r[0],u=null==(a=null==(n=null==e?void 0:e.bookings)?void 0:n[0])?void 0:a.customer;return t.createElement(i.CommandGroup,{key:"appointment_results",heading:"Appointments"},e?t.createElement(i.CommandItem,{key:e.appointment_id,value:`${e.appointment_id}`,keywords:[null==(o=e.service)?void 0:o.name],onSelect:()=>l(e)},t.createElement("div",{className:"bw-flex bw-cursor-pointer bw-items-center bw-gap-4 bw-rounded bw-py-2"},t.createElement("h4",{className:"bw-mb-0 bw-mr-4 bw-text-2xl bw-text-base-foreground"},"#",e.appointment_id),t.createElement("div",null,t.createElement("h4",{className:"bw-mb-1"},null==(s=e.service)?void 0:s.name),t.createElement("span",{className:"bw-text-sm bw-text-base-foreground/60"},c&&u&&`${b.agent}: ${c.first_name} ${c.last_name}, ${u&&`${b.customer}: ${u.first_name} ${u.last_name}`}`)))):t.createElement(H,null,"No Matched Appointment found!"))}function ga(e){if(!e)return null;let t=e.trim();if(t.startsWith("#")){t=t.substring(1);const e=parseInt(t);return Number.isNaN(e)?null:{type:"appointment",search:e}}return{type:"record",search:t}}const ya=i.styled.div("bw-py-3 bw-flex bw-items-center bw-gap-4 bw-px-4 bw-text-base bw-text-base-foreground/80"),Ea=i.styled.span("bw-text-base-foreground/80"),_a=i.styled.span("bw-text-base-foreground");function xa(){return t.createElement(t.Fragment,null,t.createElement(ya,null,t.createElement(a.NotebookPen,{className:"bw-h-5 bw-w-5"}),t.createElement(Ea,null,"Appointment search e.g:"),t.createElement(_a,null,"#123")),t.createElement(ya,null,t.createElement(a.Album,{className:"bw-h-5 bw-w-5"}),t.createElement(Ea,null,p.sprintf(p.__("%(service)s search e.g:","bookster"),b)),t.createElement(_a,null,p.sprintf(p.__("%(service)s name","bookster"),b))),t.createElement(ya,null,t.createElement(a.Contact,{className:"bw-h-5 bw-w-5"}),t.createElement(Ea,null,p.sprintf(p.__("%(customer)s or %(agent)s search e.g:","bookster"),b)),t.createElement(_a,null,"Jeremy")),t.createElement(ya,null,t.createElement(a.Phone,{className:"bw-h-5 bw-w-5"}),t.createElement(Ea,null,p.sprintf(p.__("%(customer)s or %(agent)s phone search e.g:","bookster"),b)),t.createElement(_a,null,"0123")))}function ka(){return t.createElement(ya,null,t.createElement(a.NotebookPen,{className:"bw-h-5 bw-w-5"}),t.createElement(Ea,null,"Appointment search e.g:"),t.createElement(_a,null,"#123"))}function Na(e){const t=[],r=c.useMatch(":menuId/*"),n=c.useMatch(":menuId/:subMenuId/*");return r&&r.params.menuId&&(t.push(r.params.menuId),n&&n.params.subMenuId&&t.push(`${r.params.menuId}-${n.params.subMenuId}`)),t.length>0?t:[e]}const Ca=m.createContext(void 0);function Aa(){const e=m.useContext(Ca);if(!e)throw new Error("useDetailsContext must be used within a DetailsContext.Provider");return e}function Sa({isDisabled:e=!1,selectedAppt:r,initialValues:n,children:a}){const o=d.Form.useFormInstance(),s=d.Form.useWatch(["details"],o),l=d.Form.useWatch(["payment"],o),i=s||n.details||K,u=l||n.payment||G,m=c.useAllServices(),b=(e=i)=>{const t=o.getFieldsValue(),r=t.service_id;if(!r)return;const n=U(m,r);if(!n)return;const a={...e,booking:f.booksterHooks.applyFilters(f.HOOK_NAMES.adminApptForm.detailsReloadBookingItems,{items:[w.makeBasicItem(n)],subtotal:h.ZERO},t)},s=w.calculateDetails(a),l=w.reloadPayment(u,s.tax.total);o.setFieldsValue({details:s,payment:l})},p=e=>{const t=w.calculatePayment(e,i.tax.total);o.setFieldsValue({payment:t})},v=(null==r?void 0:r.appointment_id)?"edit":"new",g={watch:{details:i,payment:u},mode:{form:v,isLoading:0===i.booking.items.length,isDisabled:e,actionEnabled:{complete:"edit"===v&&!e&&"incomplete"===u.status,recalculate:"edit"===v&&!e,cancel:"edit"===v&&!e&&o.isFieldsTouched(["details","payment"])}},reloadBooking:b,setAdjustment:t=>{if(e)return;const r={...i,adjustment:t},n=w.calculateDetails(r),a=w.calculatePayment(u,n.tax.total);o.setFieldsValue({details:n,payment:a})},setTax:e=>{const t={...i,tax:e},r=w.calculateDetails(t),n=w.calculatePayment(u,r.tax.total);o.setFieldsValue({details:r,payment:n})},setPayment:p,editTextAdjustment:e=>{o.setFieldsValue({details:{adjustment:e}})},actionComplete:()=>{p({...u,status:"complete"})},actionRecalculate:()=>{const e=f.booksterHooks.applyFilters(f.HOOK_NAMES.adminApptForm.detailsInitBlueprint,K);b({...i,tax:e.tax})},actionCancel:()=>{if(!r)return;let e=W(r,r.bookings[0],r.service);e=f.booksterHooks.applyFilters(f.HOOK_NAMES.adminApptForm.initFormValues,e,r),o.resetFields(["details","payment","service_id"]),o.setFieldsValue({service_id:e.service_id,details:e.details,payment:e.payment}),o.setFields(["service_id",["details","booking"],["details","adjustment"],["details","tax"],"payment"].map((e=>({name:e,touched:!1})))),f.booksterHooks.doAction(f.HOOK_NAMES.adminApptForm.doDetailsActionCancel,o,e)}};return t.createElement(Ca.Provider,{value:g},a)}const ja=m.createContext(void 0);function Fa(){const e=m.useContext(ja);if(!e)throw new Error("ApptFormContext.Provider missing!");return e}function Pa({value:e,onChange:r,className:n,...o}){const[s,l]=m.useState(!1),u=(null==e?void 0:e[0])||null,d=c.useAllAgents(),b=c.useActiveAgents(),p=m.useMemo((()=>{const e=u?d.find((e=>e.agent_id===u)):null;return e?t.createElement(t.Fragment,null,t.createElement("div",{className:"bw-flex bw-items-center bw-gap-1.5"},t.createElement(i.Avatar,{className:"bw-h-5 bw-w-5"},t.createElement(i.AvatarImage,{src:e.transient_avatar_url}),t.createElement(i.AvatarFallback,{className:"bw-text-xs"},t.createElement(a.UserRound,{className:"bw-h-3 bw-w-3"}))),t.createElement("span",null,`${e.first_name} ${e.last_name}`))):t.createElement("span",{className:"bw-text-base-foreground/40"},"Select a Agent...")}),[u,d]);return t.createElement(i.Popover,{open:s,onOpenChange:l},t.createElement(i.ComboboxTrigger,{className:n,...o},t.createElement("span",{className:"bw-overflow-hidden"},p),t.createElement(i.ComboboxIcon,null)),t.createElement(i.PopoverPortal,null,t.createElement(i.PopoverContent,{className:"bw-w-[var(--radix-popover-trigger-width)] bw-p-0 bw-shadow-md",side:"bottom"},t.createElement(i.Command,{loop:!0},t.createElement(i.CommandInput,{placeholder:"Enter Agent's name, email, phone..."}),t.createElement(i.CommandList,null,t.createElement(i.CommandEmpty,null,"No Agent found."),t.createElement(i.CommandGroup,null,b.map((e=>t.createElement(i.CommandItem,{key:e.agent_id,value:`${e.agent_id}`,keywords:[e.first_name,e.last_name,e.email,e.phone],onSelect:()=>{return t=e.agent_id,r&&r([t]),void l(!1);var t}},t.createElement(i.ComboboxItemIcon,{isActive:u===e.agent_id}),t.createElement("div",{className:"bw-flex bw-items-center bw-gap-1.5"},t.createElement(i.Avatar,{className:"bw-h-5 bw-w-5"},t.createElement(i.AvatarImage,{src:e.transient_avatar_url}),t.createElement(i.AvatarFallback,{className:"bw-text-xs"},t.createElement(a.UserRound,{className:"bw-h-3 bw-w-3"}))),t.createElement("span",null,`${e.first_name} ${e.last_name}`)))))))))))}function Ia({value:e,onChange:r,allowClear:n=!1,minuteStep:a=5,format:o=g,use12Hours:s="12h"==window.booksterPublicData.generalSettings.time_system,inputReadOnly:l=!0,...c}){const[i,u]=m.useState(e?v.dayjs().hour(e.hour).minute(e.minute):null);m.useEffect((()=>{(null==e?void 0:e.hour)===(null==i?void 0:i.hour())&&(null==e?void 0:e.minute)===(null==i?void 0:i.minute())||u(e?v.dayjs().hour(e.hour).minute(e.minute):null)}),[e]);const b=e=>{u(e),e&&(null==r||r(w.Helper.booktime.createFromDayjs(e)))};return t.createElement(d.TimePicker,{value:i,onChange:b,onSelect:b,allowClear:n,minuteStep:a,format:o,use12Hours:s,inputReadOnly:l,...c})}async function Oa(e){return await c.api.get(`customers/${e}`).json()}async function $a(e){return await c.api.post("customers",{json:e}).json()}async function Ma(e,t){return await c.api.patch(`customers/${e}`,{json:t}).json()}async function Ra(e,t){return await c.api.patch(`customers/${e}/link-wp-user`,{json:{email:t}}).json()}async function Ta(e){return await c.api.patch(`customers/${e}`,{json:{wp_user_id:null}}).json()}async function Da(e){return await c.api.delete(`customers/${e}`).json()}async function Ba(e){if(0!==await c.api.patch("customers/count",{json:{email:e}}).json())throw new Error(p.sprintf(p.__("%(customer)s with this email already exists!","bookster"),b))}function La({value:e,onChange:r,className:n,...o}){const[s,l]=m.useState(!1),[u,d]=m.useState(""),b=q(u,{wait:300}),p=(null==e?void 0:e[0])||null,f=c.useQueryClient(),{data:w}=c.useQuery(["customers",p],(async()=>p?await Oa(p):null)),{data:h,isFetching:v}=c.useQuery({queryKey:["customers",{keywords:b}],queryFn:async()=>b?await c.queryCustomers({keywords:b,limit:10}):await c.queryCustomers({limit:10}),keepPreviousData:!0}),g=[...w?[w]:[],...((null==h?void 0:h.data)??[]).filter((e=>!w||e.customer_id!==p))],y=m.useMemo((()=>p?t.createElement(t.Fragment,null,t.createElement("div",{className:"bw-flex bw-items-center bw-gap-1.5"},t.createElement(i.Avatar,{className:"bw-h-5 bw-w-5"},t.createElement(i.AvatarImage,{src:null==w?void 0:w.transient_avatar_url}),t.createElement(i.AvatarFallback,{className:"bw-text-xs"},t.createElement(a.UserRound,{className:"bw-h-3 bw-w-3"}))),t.createElement("span",null,w?`${w.first_name} ${w.last_name} ${w.email} ${w.phone}`:`Customer #${p}`))):t.createElement("span",{className:"bw-text-base-foreground/40"},"Select a Customer...")),[p,w]);return t.createElement(i.Popover,{open:s,onOpenChange:l},t.createElement(i.ComboboxTrigger,{className:n,...o},t.createElement("span",{className:"bw-overflow-hidden"},y),t.createElement(i.ComboboxIcon,null)),t.createElement(i.PopoverPortal,null,t.createElement(i.PopoverContent,{className:"bw-w-[var(--radix-popover-trigger-width)] bw-p-0 bw-shadow-md",side:"bottom",align:"start"},t.createElement(i.Command,{loop:!0,shouldFilter:!1},t.createElement(i.CommandInput,{placeholder:"Enter Customer name, email, phone",value:u,onValueChange:d,isFetching:v}),t.createElement(i.CommandList,null,t.createElement(i.CommandEmpty,null,"No Customers found."),t.createElement(i.CommandGroup,null,g.map((e=>t.createElement(i.CommandItem,{key:e.customer_id,value:`${e.customer_id}`,keywords:[e.first_name,e.last_name,e.email,e.phone],onSelect:()=>(e=>{f.setQueryData(["customers",e.customer_id],e),r&&r([e.customer_id]),l(!1)})(e)},t.createElement(i.ComboboxItemIcon,{isActive:p===e.customer_id}),t.createElement("div",{className:"bw-flex bw-items-center bw-gap-1.5 bw-overflow-x-hidden"},t.createElement(i.Avatar,{className:"bw-h-5 bw-w-5"},t.createElement(i.AvatarImage,{src:e.transient_avatar_url}),t.createElement(i.AvatarFallback,{className:"bw-text-xs"},t.createElement(a.UserRound,{className:"bw-h-3 bw-w-3"}))),t.createElement("span",{className:"bw-text-nowrap"},`${e.first_name} ${e.last_name} ${e.email} ${e.phone}`)))))))))))}function za({value:e,onChange:r,className:n,...a}){const[o,s]=m.useState(!1),l=e||null,u=c.useAllServices(),d=c.useActiveServices(),f=m.useMemo((()=>{const e=l?u.flatMap((e=>e.services)).find((e=>e.service_id===l)):null;return e?e.name:t.createElement("span",{className:"bw-text-base-foreground/40"},p.sprintf(p.__("Select a %(service)s ...","bookster"),b))}),[l,u]);return t.createElement(i.Popover,{open:o,onOpenChange:s},t.createElement(i.ComboboxTrigger,{className:n,...a},t.createElement("span",{className:"bw-overflow-hidden"},f),t.createElement(i.ComboboxIcon,null)),t.createElement(i.PopoverPortal,null,t.createElement(i.PopoverContent,{className:"bw-w-[var(--radix-popover-trigger-width)] bw-p-0 bw-shadow-md",side:"bottom"},t.createElement(i.Command,{loop:!0},t.createElement(i.CommandInput,{placeholder:p.sprintf(p.__("Enter %(service)s's name","bookster"),b)}),t.createElement(i.CommandList,null,t.createElement(i.CommandEmpty,null,p.sprintf(p.__("No %(services)s found.","bookster"),b)),d.map((e=>t.createElement(i.CommandGroup,{key:e.service_category_id,heading:e.name,className:"[&_[cmdk-group-heading]]:bw-ps-6"},e.services.map((e=>t.createElement(i.CommandItem,{key:e.service_id,value:e.name,onSelect:()=>{return t=e.service_id,r&&r(t),void s(!1);var t}},t.createElement(i.ComboboxItemIcon,{isActive:l===e.service_id}),e.name)))))))))))}function Va(e){const r=e.value||K.adjustment,n=m.useRef(void 0),{mode:o,setAdjustment:s,editTextAdjustment:l}=Aa();m.useEffect((()=>{if(n.current){const e=document.getElementById(`adjustment-${n.current}-title`);e&&(e.focus(),n.current=void 0)}}),[r]);const u=0===r.items.length;return t.createElement(t.Fragment,null,!o.isLoading&&r.items.map((e=>t.createElement(m.Fragment,{key:e.id},t.createElement("div",{className:"bw-col-span-1 bw-col-start-2 bw-flex bw-items-center bw-justify-end"}),t.createElement("div",{className:"bw-col-span-1 bw-mb-1"},t.createElement(i.Input,{withStatus:!1,id:`adjustment-${e.id}-title`,maxLength:20,className:"bw-h-6 bw-w-[calc(100%+0.25rem)] bw-px-1 bw-text-end",disabled:o.isDisabled,value:e.title,onChange:t=>r&&function(e,t){const n={...r};n.items=n.items.map((r=>r.id===e?{...r,title:t}:r)),l(n)}(e.id,t.target.value)})),t.createElement("div",{className:"bw-col-span-1"}),t.createElement("div",{className:"bw-col-span-1 bw-mb-1 bw-text-right"},t.createElement(N,{className:"btr-details-amount-input bw-w-[calc(100%+0.25rem)]",min:void 0,disabled:o.isDisabled,value:e.amount.numberValue,onChange:t=>function(e,t){const n={...r};n.items=n.items.map((r=>r.id===e?{...r,formula:["fixed",t]}:r)),s(n)}(e.id,t||0)})),t.createElement("div",{className:"bw-col-span-1 bw-mb-1 bw-flex bw-items-center bw-justify-end"},t.createElement(a.MinusCircle,{className:"bw-h-4 bw-w-4 bw-cursor-pointer bw-text-error hover:bw-text-error/60",onClick:()=>function(e){const t={...r};t.items=t.items.filter((t=>t.id!==e)),s(t)}(e.id)}))))),!o.isLoading&&t.createElement(Ha,{align:"center",key:"add-adjustment",className:i.clsx("bw-relative bw-col-span-3 bw-col-start-3 bw-mx-0 bw-mb-2 bw-mt-1 bw-h-0 bw-w-auto bw-gap-0",u&&"bw-mt-0")},t.createElement(Ka,{className:i.clsx(u&&"bw-h-0")}),t.createElement(qa,{asChild:!0},t.createElement(i.Button,{variant:"outline",className:"bw-h-[19px] -bw-translate-y-px bw-rounded-full bw-border-dashed bw-border-base-border bw-bg-base-bg1 bw-px-1.5 bw-text-xs bw-leading-none bw-text-primary/80",onClick:function(){const e=c.genUniqueId(),t={...r};t.items=[...t.items,{id:e,title:"",formula:["fixed",0],amount:h.ZERO}],n.current=e,s(t)}},"+ Adjust")),t.createElement(Ga,{className:i.clsx(u&&"bw-h-0")})))}const{Middle:qa,Root:Ha,Before:Ka,After:Ga}=i.SectionSeparator;function Ua(e){const r=e.value||K.booking,{mode:n,watch:a}=Aa(),o=0===a.details.adjustment.items.length;return t.createElement(t.Fragment,null,!n.isLoading&&r.items.map((e=>t.createElement(m.Fragment,{key:e.id},t.createElement("div",{className:"bw-col-span-1"}),t.createElement("div",{className:"bw-col-span-1 bw-overflow-hidden bw-text-ellipsis bw-whitespace-nowrap"},e.title),t.createElement("div",{className:"bw-col-span-1 bw-text-right"},c.formatPrice(e.unitPrice)),t.createElement("div",{className:"bw-col-span-1 bw-text-right"},"x",e.quantity),t.createElement("div",{className:"bw-col-span-1 bw-text-right"},c.formatPrice(e.amount)),t.createElement("div",{className:"bw-col-span-1"})))),!n.isLoading&&t.createElement(i.Separator,{key:"booking-sep",className:i.clsx("bw-col-span-full bw-mx-8 bw-mb-0 bw-mt-2 bw-w-auto",!o&&"bw-mb-2")}))}function Wa(e){const r=e.value||G,n=d.Form.useFormInstance().getFieldError("payment"),a=0===n.length?void 0:n[0],{mode:o,watch:s,setPayment:l,actionComplete:u,actionRecalculate:b,actionCancel:f}=Aa(),w="incomplete"===r.status;return t.createElement(t.Fragment,null,!o.isLoading&&t.createElement("div",{key:"payment-section",className:"bw-w-full"},t.createElement("div",{className:"bw-mx-[1rem] bw-my-2 bw-grid bw-gap-y-0.5 bw-rounded bw-border bw-bg-base-bg2/20 bw-px-[1rem] bw-py-2 bw-pb-1 bw-shadow",style:{gridTemplateColumns:"3fr 1fr 0.75fr 1fr",gridTemplateRows:"1fr 1fr",gridTemplateAreas:'\n                "status paid . paidamount"\n                "action due . dueamount"\n              '}},t.createElement("div",{className:"bw-inline-flex bw-items-center bw-gap-2",style:{gridArea:"status"}},t.createElement("span",null,p.__("Payment Status","bookster"),":"),t.createElement(i.Select,{disabled:o.isDisabled,value:r.status,onValueChange:e=>l({...r,status:e})},t.createElement(i.SelectTrigger,{className:"bw-h-7 bw-w-32",withStatus:!1},t.createElement(i.SelectValue,null)),t.createElement(i.SelectContent,null,t.createElement(i.SelectItem,{value:"complete"},p.__("Complete","bookster")),t.createElement(i.SelectItem,{value:"incomplete"},p.__("Incomplete","bookster")),t.createElement(i.SelectItem,{value:"refunded",disabled:"new"===o.form},p.__("Refunded","bookster")),t.createElement(i.SelectItem,{value:"voided",disabled:"new"===o.form},p.__("Voided","bookster"))))),t.createElement("div",{className:"bw-inline-flex bw-items-center bw-gap-1",style:{gridArea:"action"}},t.createElement(i.Button,{variant:"link",color:"accent",size:"small",className:i.clsx("bw-underline hover:bw-font-semibold hover:bw-tracking-tight focus:bw-font-semibold focus:bw-tracking-tight",!o.actionEnabled.complete&&"bw-hidden"),onClick:u},p.__("Complete","bookster")),t.createElement(i.Button,{variant:"link",color:"accent",size:"small",className:i.clsx("bw-underline hover:bw-font-semibold hover:bw-tracking-tight focus:bw-font-semibold focus:bw-tracking-tight",!o.actionEnabled.recalculate&&"bw-hidden"),onClick:b},p.__("Recalculate","bookster")),t.createElement(i.Button,{variant:"link",color:"base",size:"small",className:i.clsx("bw-text-base-foreground/60 bw-underline hover:bw-font-semibold hover:bw-tracking-tight focus:bw-font-semibold focus:bw-tracking-tight",!o.actionEnabled.cancel&&"bw-hidden"),onClick:f},p.__("Cancel Changes","bookster"))),w&&t.createElement(m.Fragment,{key:"paid-and-due"},t.createElement("div",{className:"bw-inline-flex bw-items-center bw-justify-end",style:{gridArea:"paid"}},p.__("Paid","bookster")),t.createElement("div",{className:"bw-inline-flex bw-w-[calc(100%+0.25rem)] bw-items-center",style:{gridArea:"paidamount"}},t.createElement(N,{className:"btr-details-amount-input bw-w-full",style:{paddingBottom:"0"},min:0,disabled:o.isDisabled,value:r.paid.numberValue,onChange:e=>l({...r,paid:h.Decimal.fromNumber(e||0)})})),t.createElement("div",{className:"bw-inline-flex bw-items-center bw-justify-end bw-font-semibold bw-leading-none bw-text-primary/80",style:{gridArea:"due"}},p.__("Due","bookster")),t.createElement("div",{className:"bw-inline-flex bw-items-center bw-justify-end bw-font-semibold bw-leading-none bw-text-primary/80",style:{gridArea:"dueamount"}},c.formatPrice(s.details.tax.total.subtract(r.paid)))))),a&&t.createElement("div",{key:"details-error",className:"bw-text-error"},a))}function Qa(e){const r=e.value||K.tax,{watch:n,mode:a}=Aa(),o=!a.isLoading&&r.items.length>0;return t.createElement(t.Fragment,null,o&&t.createElement(m.Fragment,{key:"subtotal-booking"},t.createElement("div",{className:"bw-col-span-3 bw-text-right bw-font-semibold"},"Subtotal"),t.createElement("div",{className:"bw-col-span-2 bw-text-right"},c.formatPrice(n.details.adjustment.subtotal)),t.createElement("div",{className:"bw-col-span-1"})),!a.isLoading&&r.items.map((e=>t.createElement(m.Fragment,{key:e.id},t.createElement("div",{className:"bw-col-span-1 bw-col-start-2 bw-flex bw-items-center bw-justify-end"}),t.createElement("div",{className:"bw-col-span-1 bw-overflow-hidden bw-text-ellipsis bw-whitespace-nowrap bw-text-right"},e.title),t.createElement("div",{className:"bw-col-span-2 bw-text-right"},c.formatPrice(e.amount)),t.createElement("div",{className:"bw-col-span-1 bw-flex bw-items-center bw-justify-end"})))),!a.isLoading&&t.createElement(m.Fragment,{key:"total"},t.createElement(i.Separator,{className:"bw-col-span-3 bw-col-start-3 bw-mx-0 bw-my-0 bw-h-0 bw-w-auto"}),t.createElement("div",{className:"bw-col-span-3 bw-text-right bw-font-semibold"},"Total"),t.createElement("div",{className:"bw-col-span-2 bw-text-right bw-font-semibold"},c.formatPrice(r.total||0)),t.createElement("div",{className:"bw-col-span-1"})))}function Ja(){const{mode:e}=Aa();return t.createElement(t.Fragment,null,t.createElement("div",{className:"bw-grid",style:{gridTemplateColumns:"2rem 3fr 1fr 0.75fr 1fr 2rem"}},e.isLoading&&t.createElement(m.Fragment,{key:"details-skeleton"},t.createElement("div",{className:"bw-col-span-full bw-mb-1 bw-flex bw-h-8 bw-animate-pulse bw-items-center bw-justify-center bw-rounded-md bw-bg-muted bw-text-center"},"new"===e.form&&p.sprintf(p.__("Please select a %(service)s","bookster"),b),"edit"===e.form&&"Details is Loading..."),t.createElement("div",{className:"bw-col-span-4 bw-col-start-3 bw-mb-1 bw-flex bw-h-8 bw-animate-pulse bw-items-center bw-justify-center bw-rounded-md bw-bg-muted bw-text-center"}),t.createElement("div",{className:"bw-col-span-4 bw-col-start-3 bw-mb-1 bw-flex bw-h-8 bw-animate-pulse bw-items-center bw-justify-center bw-rounded-md bw-bg-muted bw-text-center"}),t.createElement("div",{className:"bw-col-span-full bw-mb-1 bw-flex bw-h-8 bw-animate-pulse bw-items-center bw-justify-center bw-rounded-md bw-bg-muted bw-text-center"})),t.createElement(d.Form.Item,{name:["details","booking"],noStyle:!0},t.createElement(Ua,null)),t.createElement(d.Form.Item,{name:["details","adjustment"],noStyle:!0},t.createElement(Va,null)),t.createElement(d.Form.Item,{name:["details","tax"],noStyle:!0},t.createElement(Qa,null))),t.createElement(d.Form.Item,{name:"payment",noStyle:!0,rules:[({getFieldValue:e})=>({validator(t,r){const n=e("service_id"),a=e("details");return n?a&&0!==a.booking.items.length&&r?a.tax.total.isNegative()?Promise.reject(new Error("Total Amount cannot be Negative!")):Promise.resolve():Promise.reject(new Error("Booking Details is not Loaded Correctly!")):Promise.resolve()}})]},t.createElement(Wa,null)))}const{Root:Za,Before:Xa,After:Ya,Middle:eo}=i.SectionSeparator;function to(){return t.createElement(Za,{className:"bw-mb-2 bw-mt-0 bw-gap-1"},t.createElement(Xa,null),t.createElement(eo,{asChild:!0,className:"bw-cursor-pointer bw-text-base bw-font-normal bw-text-primary/80"},t.createElement("label",{htmlFor:"btr-customer-contact"},p.sprintf(p.__("%(customer)s Contact","bookster"),b))),t.createElement(Ya,null))}const{Root:ro,Before:no,After:ao,Middle:oo}=i.SectionSeparator;function so(){return t.createElement(ro,{className:"bw-mb-1 bw-mt-0 bw-gap-1"},t.createElement(no,null),t.createElement(oo,{className:"bw-text-base bw-font-normal bw-text-primary/80"},"Booking Details"),t.createElement(ao,null))}function lo({editMode:e="manager",newCustomer:r,editCustomer:n}){const a=c.useAllServices(),o=d.Form.useFormInstance(),{reloadBooking:s,mode:l}=Aa();return t.createElement(t.Fragment,null,t.createElement("div",{className:"btr-appt-form"},t.createElement("div",{className:"bw-grid bw-grid-cols-2 bw-gap-x-4"},t.createElement(d.Form.Item,{name:"service_id",label:b.service,rules:[{required:!0}]},t.createElement(za,{autoFocus:!0,onChange:e=>async function(e){const t=U(a,e);if(!t)throw new Error(p.sprintf(p.__("Invalid %(service)s id","bookster"),b));const r=o.getFieldValue("start_time")?o.getFieldValue("start_time").absMinute:0;o.setFieldsValue({buffer_before:t.buffer_before,buffer_after:t.buffer_after,start_time:w.Helper.booktime.createFromAbsMinute(r),end_time:w.Helper.booktime.createFromAbsMinute(r+t.duration)}),f.booksterHooks.doAction(f.HOOK_NAMES.adminApptForm.doChangeService,o),s()}(e),disabled:"manager"!==e})),t.createElement(d.Form.Item,{label:b.agent,name:"agent_ids",rules:[{required:!0}]},t.createElement(Pa,{disabled:"manager"!==e})),f.booksterHooks.applyFilters(f.HOOK_NAMES.adminApptForm.AfterAgent,[],e)),t.createElement("div",{className:"bw-grid bw-grid-cols-2 bw-gap-x-4"},t.createElement(d.Form.Item,{label:p.__("Book Status","bookster"),name:"book_status",rules:[{required:!0}],trigger:"onValueChange"},t.createElement(i.Select,{disabled:"disabled"===e},t.createElement(i.SelectTrigger,null,t.createElement(i.SelectValue,null)),t.createElement(i.SelectContent,null,t.createElement(i.SelectGroup,null,t.createElement(i.SelectItem,{value:"pending"},p.__("Pending Approval","bookster")),t.createElement(i.SelectItem,{value:"approved"},p.__("Approved","bookster")),t.createElement(i.SelectItem,{value:"canceled"},p.__("Canceled","bookster")))))),t.createElement(d.Form.Item,{label:p.__("Book Date","bookster"),name:"book_date",rules:[{required:!0}]},t.createElement(d.DatePicker,{className:"bw-w-full",disabled:"disabled"===e,format:y}))),t.createElement("div",{className:"bw-grid bw-grid-cols-2 bw-gap-x-4 sm:bw-grid-cols-4"},t.createElement(d.Form.Item,{label:p.__("Start Time","bookster"),name:"start_time",rules:[{required:!0}]},t.createElement(Ia,{className:"bw-w-full",disabled:"disabled"===e,placeholder:"Start Time",onChange:async function(e){const t=null==o?void 0:o.getFieldValue("service_id");if(!t)return;const r=U(a,t);if(!r)throw new Error(p.sprintf(p.__("Invalid %(service)s id","bookster"),b));o.setFieldsValue({end_time:w.Helper.booktime.createFromAbsMinute(e.absMinute+r.duration)}),o.validateFields(["end_time"])}})),t.createElement(d.Form.Item,{className:"bw-w-full",label:p.__("End Time","bookster"),name:"end_time",dependencies:["start_time"],rules:[{required:!0},{validator:function(e,t){if(!t)return Promise.resolve();const r=o.getFieldValue("start_time");return r&&t.absMinute<r.absMinute?Promise.reject("End Time must be after Start Time"):Promise.resolve()}}]},t.createElement(Ia,{className:"bw-w-full",placeholder:p.__("End Time","bookster"),disabled:"disabled"===e})),t.createElement(d.Form.Item,{className:"sm:bw-order-first",label:p.__("Buffer Before","bookster"),name:"buffer_before",rules:[{required:!0}]},t.createElement(d.InputNumber,{className:"bw-w-full",min:0,addonAfter:"mins",disabled:"disabled"===e,step:E()})),t.createElement(d.Form.Item,{label:p.__("Buffer After","bookster"),name:"buffer_after",rules:[{required:!0}]},t.createElement(d.InputNumber,{className:"bw-w-full",min:0,addonAfter:"mins",disabled:"disabled"===e,step:E()}))),t.createElement(so,null),t.createElement(Ja,null),t.createElement(to,null),t.createElement("div",{className:"bw-grid bw-grid-cols-1 bw-gap-x-4 sm:bw-grid-cols-2"},t.createElement("div",{className:"bw-col-span-2 bw-flex"},t.createElement("div",{className:"bw-mb-6 bw-grow bw-overflow-x-auto"},t.createElement(d.Form.Item,{name:"customer_ids",className:"bw-m-0",rules:[{required:!0,message:p.sprintf(p.__("Please select %(customer)s!","bookster"),b)}]},t.createElement(La,{id:"btr-customer-contact",className:"bw-rounded-e-none",disabled:"manager"!==e}))),t.createElement(i.Button,{className:"bw-z-20 bw-rounded-s-none disabled:bw-border-base-border",onClick:r,disabled:"manager"!==e},p.sprintf(p.__("New %(customer)s","bookster"),b))),f.booksterHooks.applyFilters(f.HOOK_NAMES.adminApptForm.AfterCustomerContact,[],e,l),t.createElement(d.Form.Item,{label:p.sprintf(p.__("Note by %(customer)s","bookster"),b),name:"customer_note"},t.createElement(i.Textarea,{rows:3,placeholder:p.__("Please enter Note","bookster"),disabled:"manager"!==e})),t.createElement(d.Form.Item,{label:p.__("Notes by Staff","bookster"),name:"staff_note"},t.createElement(i.Textarea,{rows:3,placeholder:p.__("Please enter Note","bookster")})),f.booksterHooks.applyFilters(f.HOOK_NAMES.adminApptForm.EndForm,[],e,l))))}function co(){const{apptId:e}=c.useParams();return isNaN(Number(e))?null:Number(e)}function io({onDelete:e,disabled:r}){return t.createElement(i.ReactPopover.Root,null,t.createElement(i.ReactPopover.Trigger,{asChild:!0},t.createElement(i.Button,{size:"icon",className:"bw-mr-auto msm:bw-hidden",variant:"outline",color:"error",disabled:r,tabIndex:-1},t.createElement(a.Trash,null))),t.createElement(C,null,t.createElement("div",{className:"bw-flex bw-items-center bw-gap-2"},t.createElement(a.Info,{className:"bw-h-5 bw-w-5 bw-fill-warning bw-text-base-bg1"}),"Are you sure you want to delete this appointment?"),t.createElement(A,null,t.createElement(i.ReactPopover.Close,{asChild:!0},t.createElement(i.Button,{variant:"trivial",size:"small"},"Cancel")),t.createElement(i.ReactPopover.Close,{asChild:!0},t.createElement(i.Button,{color:"error",variant:"outline",size:"small",onClick:()=>e()},"Delete")))))}export{va as A,Z as C,Sa as D,xa as M,Ze as P,fa as S,J as _,ha as a,Na as b,pa as c,co as d,Fa as e,lo as f,ga as g,io as h,Je as i,ka as j,ja as k,Qe as l,Ma as m,$a as n,Da as o,Oa as p,Ra as q,Ta as r,wa as u,Ba as v};
