import{b as e,L as t,e as a,c as s,q as o,u as n,d as r,R as i,f as l,_ as c,a as m,r as u,x as b}from"./prefetch.helper-4a4e89e7.js";import{d,e as w,B as p}from"./BookingFormRoot-ec114615.js";import{u as _}from"./store-87403b6b.js";import{e as g,u as f}from"./index-ad7a2af3.js";import{B as v}from"./BookingFormBlock-04332c80.js";import"./agentSchedule.helper-648c495b.js";import"./createBookTimeInput.helper-a66a36a8.js";import"./ErrorAlert-70706561.js";import"./phoneInput.helper-24509875.js";import"./index-f3d162c1.js";import"./ServiceCard-c25895f8.js";import"./BEConfigProvider-697f66d7.js";import"./holiday.helper-ca9c72dc.js";import"./index-f9ec547e.js";import"./index-8ef1ff47.js";import"./useEffectWithTarget-688d6bb0.js";const h={agent_id:1,wp_user_id:null,avatar_id:null,first_name:"Jeremy",last_name:"Johnson",email:"jeremyjohnson@gmail.com",phone:"+146527879832",activated:!0,visibility:"public",priority:10,weekly_schedule_enabled:!1,weekly_schedule:null,dayoff_schedule_enabled:!1,dayoff_schedule:null,transient_avatar_url:"",transient_gallery_urls:[],wp_user_display_name:"",available_agent_services:[],created_at:"",updated_at:""},k={service_id:1,service_category_id:1,name:e.sprintf(e.__("Booking %(service)s title","bookster"),t),description:e.sprintf(e.__("Booking %(service)s description","bookster"),t),activated:!0,visibility:"public",price:"100",duration:20,buffer_before:0,buffer_after:0,theme_color:"#66CC8A",position:10,cover_id:1,transient_cover_url:"",transient_gallery_urls:[],available_agent_services:[],created_at:"",updated_at:""},E={customer_id:1,first_name:"John",last_name:"Doe",phone:"+0123456789",email:"john@doe.com",wp_user_id:1,avatar_id:null,customer_note:"",admin_note:"",transient_avatar_url:"",wp_user_display_name:"",created_at:"",updated_at:""},x=a.dayjs(),y={hour:x.hour(),minute:x.minute(),absMinute:x.millisecond()},N=x.add(k.duration,"minute"),z=x.format("YYYY-MM-DD HH:mm:ss"),S=N.format("YYYY-MM-DD HH:mm:ss"),C={state:"success",transaction:{transaction_id:1,transaction_secret_id:"secret-1234",appointment_id:1234,customer_id:1,payment_gateway:"payment-stripe",amount:"99.99",transaction_status:"succeeded",transaction_message:"Powered by Bookster Stripe",transaction_link:"",transaction_meta:{},created_at:"",updated_at:""},appointment:{service:k,booking:{customer:E,booking_id:1,appointment_id:1234,customer_id:1,payment_status:"complete",total_amount:"99.99",paid_amount:"99.99",customer_note:"",booking_details:{booking:{items:[],subtotal:0},adjustment:{items:[],subtotal:0},tax:{items:[],total:0}}},booking_count:1,agents:[h],appointment_id:1234,service_id:k.service_id,agent_ids:[h.agent_id],location_id:null,book_status:"approved",datetime_start:z,abs_min_start:y.absMinute,utc_datetime_start:z,datetime_end:S,abs_min_end:y.absMinute+k.duration,busy_datetime_start:z,busy_abs_min_start:y.absMinute,busy_datetime_end:S,busy_abs_min_end:y.absMinute+k.duration,buffer_before:0,buffer_after:0,staff_note:"",created_at:"",updated_at:""},customer:E};function j(){const e=o.useBookingStore(),t=o.useBookingConfig(),a=t.process.steps,{customerRecord:i,wpUserInfo:l}=n(),c=s.usePublicActiveServices(),m=s.usePublicActiveAgents(),u=c.find((e=>e.services.length>0));function b(e){let t=k;u&&u.services.length>0&&(t=u.services[0]),e.select.service=t}function d(e){let t=h;m.length>0&&(t=m[0]),e.select.agent=t}function p(e){e.datetime.picker.bookDate=x,e.datetime.picker.bookTime=y,e.select.bookTime=y,e.select.bookDate=x}function _(e){const t={values:{first_name:(null==i?void 0:i.first_name)||(null==l?void 0:l.firstName)||"Customer",last_name:(null==i?void 0:i.last_name)||(null==l?void 0:l.lastName)||"Demo",email:(null==i?void 0:i.email)||(null==l?void 0:l.email)||"customer_demo@gmail.com",phone:(null==i?void 0:i.phone)||"+123456789",customer_id:(null==i?void 0:i.customer_id)||1,customer_note:""},isNewCustomer:!1};e.select.contact=t}function g(e){e.select.payOption=window.booksterPublicData.paymentGateway.now?"full":"later",e.booked=C}return{jumpToStep:function(s){e.setState((e=>{!function(e){const a=w(t);delete a.customize,Object.assign(e,a)}(e);for(let t=0;t<a.length;t++){const o=a[t];if("datetime"===o.name&&p(e),o.name===s)return e.process.current.stepIndex=t,void(e.process.current.actIndex=0);switch(o.name){case"service":b(e);break;case"agent":d(e);break;case"datetime":break;case"contact":_(e);break;case"checkout":g(e)}r.booksterHooks.doAction(r.HOOK_NAMES.customize.setDemoStepValue,o,e)}}))}}}function F({step:t}){const a=o.useBookingStore(),{jumpToStep:s}=j(),{run:n}=g((e=>{a.setState((a=>{a.customize.content.steps[t.name].title=e}))}),{wait:100,maxWait:200}),{run:r}=g((e=>{a.setState((a=>{a.customize.content.steps[t.name].description=e}))}),{wait:100,maxWait:200});return i.createElement("div",{className:"bw-grid bw-w-full bw-grid-cols-2 bw-gap-3 bw-border-primary/20",key:t.name,onFocus:()=>s(t.name)},i.createElement(l.Form.Item,{label:i.createElement("span",{className:"bw-capitalize"},t.name," ",e.__("Title","bookster")),name:["customize","content","steps",t.name,"title"],rules:[{required:!0,message:e.__("Please enter Title!","bookster")}]},i.createElement(c.Input,{placeholder:"The Step Title",maxLength:18,onChange:e=>n(e.target.value)})),i.createElement(l.Form.Item,{label:i.createElement("span",{className:"bw-capitalize"},t.name," ",e.__("Description","bookster")),name:["customize","content","steps",t.name,"description"],rules:[{required:!0,message:e.__("Please enter Description!","bookster")}]},i.createElement(c.Textarea,{rows:2,maxLength:50,onChange:e=>r(e.target.value)})))}function M(){const t=o.useBookingStore(),a=o.useBookingConfig().process.steps,{run:s}=g((e=>{t.setState((t=>{t.customize.content.help=e}))}),{wait:100,maxWait:200});return i.createElement(i.Fragment,null,a.map((e=>i.createElement(F,{key:e.name,step:e}))),i.createElement(l.Form.Item,{label:e.__("Help","bookster"),name:["customize","content","help"],rules:[{required:!0}]},i.createElement(c.Textarea,{rows:2,maxLength:50,onChange:e=>s(e.target.value)})))}function B(){const e=s.useMatch("customize/:menuId"),t=null==e?void 0:e.params.menuId;return i.createElement(i.Fragment,null,i.createElement("div",{className:c.cx("btr-scrollbar-sm bw-absolute bw-top-0 bw-h-full bw-w-full -bw-translate-x-full bw-overflow-y-auto bw-bg-base-bg1 bw-p-5 bw-duration-300","steps-content"===t&&"bw-translate-x-0")},i.createElement(M,null)),r.booksterHooks.applyFilters(r.HOOK_NAMES.customize.MenuContents,[],{className:"btr-scrollbar-sm bw-absolute -bw-translate-x-full bw-top-0 bw-h-full bw-w-full bw-overflow-y-auto bw-bg-base-bg1 bw-p-5 bw-duration-300"}))}function H(){const t=s.useNavigate(),a=s.useMatch("customize/:menuId"),o=null==a?void 0:a.params.menuId;return i.createElement("h2",{className:"bw-flex bw-items-center bw-gap-4 bw-border-0 bw-border-b bw-border-solid bw-border-base-border bw-px-5 bw-py-4 bw-text-xl bw-capitalize bw-shadow-sm"},!o&&i.createElement(i.Fragment,null,i.createElement(m.SlidersHorizontal,{className:"bw-h-6 bw-w-6"})," ",e.__("Customize","bookster")),o&&i.createElement(i.Fragment,null,i.createElement(m.ChevronLeft,{className:"bw-h-6 bw-w-6 bw-cursor-pointer bw-text-lg bw-text-base-foreground/60 bw-transition-all hover:bw-text-black",onClick:()=>t("/customize")}),o.split("-").join(" ")))}function I(t){const a=s.useNavigate();return i.createElement("div",{...t},i.createElement("div",{className:"bw-flex bw-cursor-pointer bw-items-center bw-justify-between bw-gap-3 bw-rounded bw-p-2 bw-text-lg bw-transition-all hover:bw-bg-base-bg2",onClick:()=>a("/customize/steps-content")},i.createElement(m.TextCursorInput,{className:"bw-h-5 bw-w-5"}),i.createElement("span",{className:"bw-grow"},e.__("Steps Content","bookster")),i.createElement(m.ChevronRight,{className:"bw-h-5 bw-w-5"})),r.booksterHooks.applyFilters(r.HOOK_NAMES.customize.MenuItems,[],{className:"bw-flex bw-cursor-pointer bw-items-center bw-justify-between bw-gap-3 bw-rounded bw-p-2 bw-text-lg bw-transition-all hover:bw-bg-base-bg2"}))}function T({layoutToggle:t,className:a,...n}){const r=_((e=>e.settings.isLoading)),l=o.useBookingStore(),u=o.useBookingConfig(),{jumpToStep:b}=j(),d=null===s.useMatch("customize/:menuId");return i.createElement("div",{className:c.cx("bw-flex bw-flex-col",a),...n},i.createElement(H,null),i.createElement("div",{className:"bw-relative bw-flex-auto bw-overflow-hidden"},i.createElement(I,{className:c.cx("btr-scrollbar-sm bw-absolute bw-h-full bw-w-full bw-translate-x-0 bw-overflow-y-auto bw-overflow-x-hidden bw-p-4 bw-duration-300",!d&&"bw-translate-x-full")}),i.createElement(B,null)),i.createElement("div",{className:"bw-flex bw-justify-between bw-border-0 bw-border-t bw-border-solid bw-border-base-border bw-px-5 bw-py-3"},i.createElement("div",{className:"bw-flex bw-gap-2"},t,i.createElement(c.Button,{variant:"ghost",size:"icon",color:"base",onClick:()=>function(){const e=l.getState().process.current.stepIndex,t=u.process.steps;e>0&&b(t[e-1].name)}()},i.createElement(m.ChevronLeft,null)),i.createElement(c.Button,{variant:"ghost",size:"icon",color:"base",onClick:()=>function(){const e=l.getState().process.current.stepIndex,t=u.process.steps;e<t.length-1&&b(t[e+1].name)}()},i.createElement(m.ChevronRight,null))),i.createElement(c.LoadingButton,{disabled:r,loading:r,className:"bw-px-6",type:"submit"},e.__("Save","bookster"))))}function A({className:e,...t}){const a=l.Form.useFormInstance(),s=l.Form.useWatch([],a),n=o.useBookingState((e=>e.customize)),c=r.booksterHooks.applyFilters(r.HOOK_NAMES.customize.initialValues,{customize:n}),m=s||c,d=u.useMemo((()=>r.booksterHooks.applyFilters(r.HOOK_NAMES.customize.previewCssVariables,{},m)),[m]),w=f(d,{wait:150,maxWait:500}),p=u.useMemo((()=>r.booksterHooks.applyFilters(r.HOOK_NAMES.customize.previewAntdConfig,b,m)),[m]),_=f(p,{wait:150,maxWait:500});return i.createElement(O,{antdConfig:_,className:e,style:w,...t})}const O=i.memo((function({antdConfig:e,...t}){return i.createElement(l.ConfigProvider,{...e},i.createElement("div",{...t},i.createElement(v,null)))}));function D(){const[e,t]=u.useState("desktop"),a=_((e=>e.settings.isLoading)),n=o.useBookingState((e=>e.customize)),b=_((e=>e.settingsUpdateCustomize)),[d]=l.Form.useForm(),{toast:w}=c.useToast(),p=r.booksterHooks.applyFilters(r.HOOK_NAMES.customize.initialValues,{customize:n});return i.createElement(l.Form,{form:d,layout:"vertical",disabled:a,initialValues:p,onFinish:async function(e){try{await b(e),w.success("Update customize setting success!")}catch(t){w.error(await s.getErrorMsg(t))}},className:"bw-h-full"},i.createElement("div",{className:"bw-flex bw-h-full bw-w-full bw-border-0 bw-bg-base-bg1 bw-p-0"},i.createElement(c.ScrollArea,{className:"bw-h-full bw-w-full bw-flex-grow mlg:bw-hidden"},i.createElement("div",{className:"bw-relative bw-mx-auto bw-my-8 bw-h-[42rem] bw-w-[70rem] 2xl:bw-my-16"},i.createElement("div",{className:"bw-absolute bw-inset-0 bw-z-10"})," ",i.createElement("div",{className:"bw-absolute bw-inset-0 bw-z-0"},i.createElement(A,{className:c.cx("bookster-root","mobile"===e&&"bw-m-auto bw-w-[34rem]","desktop"===e&&"bw-m-auto bw-w-[65rem]")}))),i.createElement(c.Scrollbar,{orientation:"horizontal"})),i.createElement(T,{className:"bw-z-10 bw-h-full bw-w-[38rem] bw-flex-none bw-border-0 bw-border-l bw-border-solid bw-border-base-border bw-shadow-xl mlg:bw-flex-grow",layoutToggle:i.createElement(c.Button,{variant:"ghost",size:"icon",color:"base",onClick:()=>t("desktop"===e?"mobile":"desktop")},"desktop"===e?i.createElement(m.ArrowLeftToLine,null):i.createElement(m.ArrowRightFromLine,null))})))}function L(){const[e,t]=u.useState((()=>r.booksterHooks.applyFilters(r.HOOK_NAMES.customize.initialPreviewConfig,{context:{formId:s.genUniqueId(),parent:{is:"body",parentWidth:1040}},process:d()})));return i.createElement(o.PreviewConfigContext.Provider,{value:{setConfig:t}},i.createElement(p,{config:e},i.createElement(D,null)))}export{L as default};
